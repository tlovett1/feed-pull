(function(e,n,a){"use strict";var t=function(){function t(){function t(){return h.find("tr").last().attr("data-mapping-row-id")}function i(){return v.find("tr").last().attr("data-namespace-row-id")}function p(){e(this).parents("tr").fadeOut().remove()}function l(){function n(){e(this).remove(),1>v.find("tr").length&&_.hide()}e(this).parents("tr").fadeOut(400,n)}function c(){var e=parseInt(t())+1,n=j({rowID:e});h.append(n)}function r(){var e=parseInt(i())+1,n=b({rowID:e,namespace_prefix:"",namespace_url:""});v.append(n),_.show()}function s(){x.animate({opacity:1}),e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"pull",nonce:a.pull_nonce,source_feed_id:y.val()}}).always(function(){x.animate({opacity:0})})}function u(){e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"get_namespaces",nonce:a.get_namespaces_nonce,feed_url:I.val()}}).done(function(n){if(I.val()!==k)if(n.namespaces&&n.namespaces[""]!==undefined){m.html(a.unprefixed_root_namespace);var t=!0;if(v.find("input[type=text]").each(function(){("default"==e(this).val()||e(this).val()==n.namespaces[""])&&(t=!1)}),t){var p=parseInt(i())+1,o=b({rowID:p,namespace_prefix:"default",namespace_url:n.namespaces[""]});v.append(o),_.show()}}else m.html(a.prefixed_root_namespace)}).always(function(){k=I.val()})}var f=e("#fp_field_mapping"),d=e("#fp_source_details"),m=d.find(".custom-namespaces-description"),_=d.find("table"),v=_.find("tbody"),w=f.find("table"),h=w.find("tbody"),g=e("#fp_manual_pull"),y=e("#post_ID"),x=e("#fp-spinner"),I=e("#fp_feed_url"),j=n.template(e("#mapping-row-template").html(),o),b=n.template(e("#namespace-row-template").html(),o);e("#log-item-template").html();var k=null;u(),w.on("click","input.delete",p),f.on("click","input.add-new",c),_.on("click","input.delete",l),d.on("click","input.add-new",r),I.on("blur",u),g.on("click",s)}function i(){return null===p&&(p=new t),p}var p=null,o={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return{getInstance:i}}();t.getInstance()})(jQuery,_,FP_Settings,window);