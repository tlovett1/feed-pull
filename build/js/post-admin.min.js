(function(e,n,a){"use strict";var t=function(){function t(){function t(){return y.find("tr").last().attr("data-mapping-row-id")}function i(){return v.find("tr").last().attr("data-namespace-row-id")}function l(){e(this).parents("tr").fadeOut().remove()}function s(){function n(){e(this).remove(),1>v.find("tr").length&&h.hide()}e(this).parents("tr").fadeOut(400,n)}function c(){var e=parseInt(t())+1,a=n.template(S,{rowID:e},p);y.append(a)}function o(){var e=parseInt(i())+1,a=n.template(T,{rowID:e,namespace_prefix:"",namespace_url:""},p);v.append(a),h.show()}function u(){I.hide(),I.html(""),j.hide(),j.html(""),b.animate({opacity:1}),e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"pull",nonce:a.pull_nonce,source_feed_id:k.val()}}).always(function(e){e&&e.success!==undefined&&(j.html(e.message),j.fadeIn("fast")),b.animate({opacity:0})})}function r(){I.hide(),I.html(""),b.animate({opacity:1}),e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"pull_test",nonce:a.pull_nonce,source_feed_id:k.val()}}).always(function(e){e&&e.success!==undefined&&(I.html(e.message),I.fadeIn("fast")),b.animate({opacity:0})})}function d(){e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"get_namespaces",nonce:a.get_namespaces_nonce,feed_url:D.val()}}).done(function(t){if(D.val()!==O)if(t.namespaces&&t.namespaces[""]!==undefined){_.html(a.unprefixed_root_namespace);var l=!0;if(v.find("input[type=text]").each(function(){("default"==e(this).val()||e(this).val()==t.namespaces[""])&&(l=!1)}),l){var s=parseInt(i())+1,c=n.template(T,{rowID:s,namespace_prefix:"default",namespace_url:t.namespaces[""]},p);v.append(c),h.show()}}else _.html(a.prefixed_root_namespace)}).always(function(){O=D.val()})}var f=e("#fp_field_mapping"),m=e("#fp_source_details"),_=m.find(".custom-namespaces-description"),h=m.find("table"),v=h.find("tbody"),w=f.find("table"),y=w.find("tbody"),g=e("#fp_manual_pull_run"),x=e("#fp_manual_pull_test"),I=e("#fp_manual_content"),j=e("#fp_log .inside"),k=e("#post_ID"),b=e("#fp-spinner"),D=e("#fp_feed_url"),S=e("#mapping-row-template").html(),T=e("#namespace-row-template").html();e("#log-item-template").html();var O=null;d(),w.on("click","input.delete",l),f.on("click","input.add-new",c),h.on("click","input.delete",s),m.on("click","input.add-new",o),D.on("blur",d),g.on("click",u),x.on("click",r)}function i(){return null===l&&(l=new t),l}var l=null,p={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};return{getInstance:i}}();t.getInstance()})(jQuery,_,FP_Settings,window);